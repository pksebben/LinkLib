!-- following the advice here: https://pythonise.com/categories/javascript/infinite-lazy-loading -->
{% extends "base.html" %}
{% block head %}
<link rel="stylesheet" href="templates/styles.css">
{% endblock %}
{% block content %}
	<div class="header">
	    <h1>Recurse Library</h1>
	    <img src="https://imgs.xkcd.com/comics/standards.png" href="https://xkcd.com/927/" />
	    <h3>What is this?</h3>
	    <p>
		To be honest, I'm not sure myself.  It started as a way to tie together all the various Recurse "things". It has become more of a stumbleupon / hackernews mashup with a set of "affiliate" links (affiliates like blaggregator).  I'm hoping it becomes something of a conversation. 
	    </p>
	</div>
	</div>
	
	<div class="index-container">
	    <div class="row">

		<div class="link-section">
		    <div class="link-section-header">
			<h2>The Links</h2>
			<p>Here they are, the Zulip links.  Each link has an associated comment thread, buttons to flag the link as "high-value", "interesting", or even "candidate for culling" (in the likely event that it does not represent something likely to be interesting to anyone outside of the conversation in which it originated).  In the comments, you can vote to pin a comment as a permanent sort of link description, which will bubble it to the top of the conversation so that it's the first thing someone sees when they see the link (hopefully, reducing the amount of time spent assessing what to click)</p>
			<p>Links are sorted by categories that map perfectly to the zulip streams.  If a link is in the wrong stream, or belongs in multiple streams, you can flag it as such using the provided flags.  We expect that this will be the case fairly often.</p>
		    </div>
		    <select class="link-buffer-selector" id="stream-selector" onchange=reload_linkbuffer()>
			{% for stream in streams %}
			<option value={{ stream["stream_id"] }}>{{ stream["name"] }}</option>
			{% endfor %}
		    </select>
		    <!-- following nav added b/c: https://pythonise.com/categories/javascript/infinite-lazy-loading -->
		    <nav class="navbar navbar-light bg-light sticky-top">
			<div class="container">
			    <a class="navbar-brand" id="loaded" href="#">0 items loaded</a>
			</div>
		    </nav>

		    <div class="link-buffer" id="link-buffer">

			<template class="link-template" id="link-template">
			    <a class="link-url-header" id="uri">link.url</a>
			    <a class="link-page-link" id="link-page-link">discussion</a>
			    <p class="link-domain" id="content">link.domain</p>
			    <p class="link-streamname" id="link-stream">link.stream_name</p>
			    <ul class="link-tags">tag for tag in link.tags</ul>
			    <a class="link-message-link" id="link-message-link">Zulip context</a>
			    <p class="link-description">link.description</p>
			    <div class="link-comment-section">
				<div class="link-comment-section-add-comment">
				    <h4>here, I want people to be able to comment on a shared link</h4>
				</div>
			    </div>
			</template>

		
		    </div>


	
		</div>

		<div class="rfc-section">
		    <h2 class="rfc-header-title">Request For Comments</h2>
		    <p class="rfc-header-greeting">I'm really interested in what you all want out of a thing like this, whatever it might be.  Tell me what you'd like to see and I'll see if it can be implemented.  Alternatively, if you wanna hack on this thing I am absolutely not precious about it.  I actually had the (probably bad) idea to allow remote code execution for anyone with a valid Oauth from RC.  Yes, on purpose.  Nothing is off the table.  I haven't made that happen but I'm kinda itching to see what would happen.  I bet it would be super cool.</p>
		    <div class="rfc-buffer">
			 <div class="comment-input">
			      {{ macro.add_comment() }}
			</div>
			<div class="comment-area">
			    {% for comment in rfc_comments %}
			    {{ macro.comment(comment.content, comment.author.name, comment.timestamp, comment.id, comment.children) }}
			    {% endfor %}
			</div>
		    </div>
		</div>
	    </div>
	</div>
	<div class="d-flex justify-content-center mb-3" id="sentinel">
	    <!-- this needs appropriate styling to function properly.  -->
	    <!-- it used to operate, when we were stil a bootstrap site -->
	    <div class="spinner-border" role="status"></div>
	</div>

	{% endblock %}
    </body>
</html>
